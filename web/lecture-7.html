<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>调试与性能分析 - 计算机的缺失课程</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'moon-white': '#F5F5F5',
              'sky-blue-tint': '#F0F9FF',
              'silver-rat-grey': '#E5E7EB',
              'ink-black': '#111827',
              'crow-blue': '#1E40AF',
              'medium-grey': '#6B7280',
              'indigo-highlight': '#0EA5E9',
            },
            fontFamily: {
              'sans-cn': ['"Source Han Sans SC"', 'PingFang SC', 'sans-serif'],
              'sans-en': ['Inter', 'Manrope', 'sans-serif'],
            }
          }
        }
      }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Manrope:wght@400;700&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    <!-- Add PrismJS for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <style>
      body { font-family: theme('fontFamily.sans-cn'); }
      .font-sans-en { font-family: theme('fontFamily.sans-en'); }
      .font-sans-cn { font-family: theme('fontFamily.sans-cn'); }
      pre[class*="language-"], .custom-code-block { background-color: #1E293B; color: #E2E8F0; padding: theme('spacing.6'); border-radius: theme('borderRadius.xl'); overflow-x: auto; margin-top: theme('spacing.4'); margin-bottom: theme('spacing.6'); }
      code:not(pre code), .custom-inline-code { background-color: theme('colors.slate.700'); color: theme('colors.slate.200'); padding: theme('spacing.1') theme('spacing.2'); border-radius: theme('borderRadius.md'); font-size: 0.9em; }
      kbd { background-color: theme('colors.slate.600'); color: theme('colors.slate.100'); padding: theme('spacing.px') theme('spacing.1'); border-radius: theme('borderRadius.md'); font-family: theme('fontFamily.mono'); font-size: 0.85em; border: 1px solid theme('colors.slate.500'); box-shadow: 1px 1px 1px theme('colors.slate.900'); }
    </style>
</head>
<body class="bg-slate-900 text-slate-200"> 

    <header class="py-4 shadow-lg sticky top-0 bg-slate-800/90 backdrop-blur-md z-50 border-b border-slate-700">
        <nav class="container mx-auto px-6 md:px-8 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold font-sans-cn">
                <span class="text-moon-white">缺失</span><span class="text-indigo-highlight">环节</span>
            </a>
            <div>
                <a href="index.html#bento-grid" class="font-sans-cn text-slate-300 hover:text-indigo-highlight ml-6">课程列表</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        <section class="mb-12 pt-8 text-center">
            <h1 class="font-sans-cn font-bold text-5xl md:text-7xl text-moon-white mb-2">
                调试与性能分析
            </h1>
            <p class="font-sans-en text-lg md:text-xl text-medium-grey">
                 Debugging and Profiling
            </p>
        </section>

        <div class="space-y-8 md:space-y-12">
            <!-- Debugging Introduction & Printf -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">调试 (Debugging) - 基础</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>调试是发现并修复代码中错误（Bug）的艺术和科学。如课程所言，代码执行的是你<em class="italic">告诉</em>它的逻辑，而非你<em class="italic">期望</em>的逻辑。</p>
                        
                        <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-6 mb-3">Printf 调试 (临时打印)</h3>
                        <p>虽然存在强大的调试器，但永远不要低估简单打印语句的力量。这是最基本也最直接的调试方法。</p>
                        <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4 mt-2">
                            <li><strong>概念:</strong> 在代码关键位置插入打印语句（如 Python 的 <code class="custom-inline-code">print()</code>, JavaScript 的 <code class="custom-inline-code">console.log()</code>）来检查变量状态或程序执行流程。</li>
                            <li><strong>优点:</strong> 快速简单、无需额外工具、跨语言通用。</li>
                            <li><strong>缺点:</strong> 容易弄乱代码、忘记移除会导致生产环境输出混乱、每次修改需重新运行、不适用于复杂或时序敏感问题。</li>
                            <li><strong>现代技巧:</strong>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                    <li>使用 f-string (Python) 或模板字面量 (JS) 提升可读性: <code class="custom-inline-code">print(f"User ID: {user_id}, Status: {status}")</code></li>
                                    <li>Python 3.8+ 可直接打印变量名和值: <code class="custom-inline-code">print(f"{user_id=}, {status=}")</code></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Logging Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h3 class="font-sans-cn text-2xl font-bold text-indigo-highlight mb-6 text-center">日志 (Logging)</h3>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>日志记录是比临时打印更系统化、更健壮的方法。</p>
                        <h4 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-6 mb-3">日志相对于 Printf 的优势</h4>
                         <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4 mt-2">
                            <li><strong class="font-bold">可配置输出:</strong> 可将日志输出到控制台、文件、网络、或专门的日志系统。</li>
                            <li><strong class="font-bold">严重性级别:</strong> 标准级别 (<code class="custom-inline-code">DEBUG</code>, <code class="custom-inline-code">INFO</code>, <code class="custom-inline-code">WARNING</code>, <code class="custom-inline-code">ERROR</code>, <code class="custom-inline-code">CRITICAL</code>) 允许按重要性过滤日志。</li>
                            <li><strong class="font-bold">格式化与上下文:</strong> 通常包含时间戳、模块名、行号等信息。</li>
                            <li><strong class="font-bold">运行时控制:</strong> 通常可在运行时调整日志级别，无需修改代码，便于生产环境诊断。</li>
                            <li><strong class="font-bold">结构化日志 (Structured Logging):</strong> 使用 JSON 等格式，便于机器解析、查询和分析（如使用 ELK, Loki, Splunk）。
                                <details class="mt-2 bg-slate-700 p-3 rounded-lg">
                                     <summary class="cursor-pointer text-indigo-highlight/80 hover:text-indigo-highlight text-xs font-semibold">查看 Python 结构化日志示例 (python-json-logger)</summary>
                                     <div class="pt-3 text-slate-300 text-xs space-y-2">
                                        <pre class="custom-code-block text-xs whitespace-pre-wrap"><code class="language-python">import logging
from pythonjsonlogger import jsonlogger

logger = logging.getLogger(__name__)
logHandler = logging.StreamHandler()
# Define format for structured logging
formatter = jsonlogger.JsonFormatter('%(asctime)s %(levelname)s %(name)s %(message)s %(filename)s %(lineno)d')
logHandler.setFormatter(formatter)
logger.addHandler(logHandler)
logger.setLevel(logging.INFO)

# Log message with extra context fields
logger.info("User action", extra={'user_id': 42, 'activity': 'view_page'})
# Output (example): {"asctime": "...", "levelname": "INFO", "name": "__main__", "message": "User action", ..., "user_id": 42, "activity": "view_page"}</code></pre>
                                    </div>
                                </details>
                            </li>
                        </ul>
                        
                        <h4 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">Python <code class="custom-inline-code">logging</code> 模块示例</h4>
                        <pre class="custom-code-block"><code class="language-python">import logging

logging.basicConfig(
    level=logging.DEBUG, # 设置最低捕获级别
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    datefmt='%Y-%m-%d %H:%M:%S',
    handlers=[
        logging.FileHandler("app.log"), # 输出到文件
        logging.StreamHandler()      # 输出到控制台
    ]
)

logger = logging.getLogger(__name__) # 获取当前模块的 logger

def my_function(x, y):
    logger.debug(f"my_function called with x={x}, y={y}")
    try:
        result = x / y
        logger.info(f"Division successful: {result}")
        return result
    except ZeroDivisionError as e:
        # logger.error("Error dividing by zero", exc_info=True) # exc_info=True 记录堆栈跟踪
        logger.exception("Error dividing by zero") # 更简洁的方式记录错误和堆栈
        return None

my_function(10, 2)
my_function(10, 0)</code></pre>
                        <p class="text-xs text-slate-400">运行此脚本将在控制台和 <code class="custom-inline-code">app.log</code> 文件中看到日志。尝试修改 <code class="custom-inline-code">level=logging.DEBUG</code> 为 <code class="custom-inline-code">INFO</code> 会减少输出。</p>

                         <h4 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">日志着色与系统日志</h4>
                         <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4 mt-2">
                             <li>可以使用 ANSI escape codes 或特定库（如 Python 的 <code class="custom-inline-code">coloredlogs</code>）为日志添加颜色。</li>
                             <li>系统级日志工具非常重要：
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                    <li><code class="custom-inline-code">journalctl</code> (Linux/systemd): <code class="custom-inline-code">-u service</code>, <code class="custom-inline-code">-f</code>, <code class="custom-inline-code">--since</code>, <code class="custom-inline-code">-p level</code>, <code class="custom-inline-code">-o json</code></li>
                                    <li><code class="custom-inline-code">log show</code> (macOS): <code class="custom-inline-code">--predicate 'filter'</code>, <code class="custom-inline-code">--last time</code></li>
                                    <li>容器日志: <code class="custom-inline-code">docker logs</code>, <code class="custom-inline-code">kubectl logs</code></li>
                                    <li>日志导航: <code class="custom-inline-code">lnav</code></li>
                                    <li>集中式日志系统: ELK Stack, Grafana Loki, Splunk, Datadog 等。</li>
                                </ul>
                            </li>
                         </ul>
                    </div>
                 </div>
            </div>
            <!-- Debuggers Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">调试器 (Debuggers)</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>当日志信息不足以定位问题时，交互式调试器允许你暂停程序执行，逐行检查代码，并深入了解程序状态。</p>
                        <h4 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-6 mb-3">核心调试器功能</h4>
                         <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4 mt-2">
                            <li><strong class="font-bold">断点 (Breakpoints):</strong> 在代码的特定行设置断点，程序执行到此行时会暂停。可以设置条件断点，仅在满足特定条件时暂停。</li>
                            <li><strong class="font-bold">步进 (Stepping):</strong>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                    <li><strong class="font-bold">Step Over (单步跳过):</strong> 执行当前行。如果当前行是函数调用，则执行整个函数，然后停在下一行。</li>
                                    <li><strong class="font-bold">Step Into (单步进入):</strong> 如果当前行是函数调用，则进入该函数内部的第一行暂停。</li>
                                    <li><strong class="font-bold">Step Out (单步跳出):</strong> 继续执行直到当前函数返回，然后停在调用该函数之处的下一行。</li>
                                </ul>
                            </li>
                             <li><strong class="font-bold">检查变量 (Inspect Variables):</strong> 查看当前作用域内所有变量的值，有时甚至可以修改它们。</li>
                             <li><strong class="font-bold">调用栈 (Call Stack):</strong> 查看导致程序执行到当前位置的函数调用链。</li>
                             <li><strong class="font-bold">监视表达式 (Watch Expressions):</strong> 添加表达式，调试器会在每次暂停时计算并显示它们的值。</li>
                        </ul>
                        
                        <h4 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">Python 调试器 (<code class="custom-inline-code">pdb</code> 及其他)</h4>
                        <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4 mt-2">
                            <li><code class="custom-inline-code">pdb</code> 是 Python 内置的命令行调试器。
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                    <li>常用命令: <code class="custom-inline-code">l(ist)</code>, <code class="custom-inline-code">n(ext)</code>, <code class="custom-inline-code">s(tep)</code>, <code class="custom-inline-code">c(ontinue)</code>, <code class="custom-inline-code">b(reak) [line_no]</code>, <code class="custom-inline-code">p(rint) expression</code>, <code class="custom-inline-code">q(uit)</code>, <code class="custom-inline-code">bt</code> (backtrace)。</li>
                                    <li>现代调用 (Python 3.7+): 在代码中插入 <code class="custom-inline-code">breakpoint()</code> 即可启动调试器，无需导入。</li>
                                </ul>
                            </li>
                            <li><code class="custom-inline-code">ipdb</code>: 提供了更好的用户体验（如 Tab 补全、语法高亮），是 <code class="custom-inline-code">pdb</code> 的常用替代品 (<code class="custom-inline-code">pip install ipdb</code> 后使用 <code class="custom-inline-code">import ipdb; ipdb.set_trace()</code>)。</li>
                            <li><strong class="font-bold">IDE 调试器 (VS Code, PyCharm 等):</strong> 强烈推荐！它们提供图形化界面，使得设置断点、查看变量、检查调用栈等操作更加直观和高效。熟练使用 IDE 调试器是提高生产力的关键。</li>
                        </ul>

                        <h4 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">低级调试器 (<code class="custom-inline-code">gdb</code>, <code class="custom-inline-code">lldb</code>)</h4>
                         <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4 mt-2">
                            <li>主要用于 C, C++, Rust 等编译型语言。</li>
                            <li>可以附加到正在运行的进程或分析核心转储文件 (core dumps)。</li>
                            <li>常用命令 (gdb 示例): <code class="custom-inline-code">gdb ./program</code>, <code class="custom-inline-code">break main</code>, <code class="custom-inline-code">run</code>, <code class="custom-inline-code">next (n)</code>, <code class="custom-inline-code">step (s)</code>, <code class="custom-inline-code">continue (c)</code>, <code class="custom-inline-code">print var (p var)</code>, <code class="custom-inline-code">backtrace (bt)</code>, <code class="custom-inline-code">info locals</code>。</li>
                            <li>存在 <code class="custom-inline-code">pwndbg</code>, <code class="custom-inline-code">GEF</code>, <code class="custom-inline-code">PEDA</code> 等插件可以增强 gdb 的界面和功能。</li>
                        </ul>

                        <h4 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">远程调试</h4>
                        <p>许多调试器支持远程调试，允许你在本地机器上调试运行在远程服务器或容器中的进程。具体设置方法因语言和工具而异。</p>
                    </div>
                 </div>
            </div>
            <!-- Specialized Debugging Tools Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">特定场景调试工具</h2>
                    <div class="space-y-8 text-slate-300 text-base leading-relaxed">
                        
                        <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                            <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fas fa-shoe-prints mr-2 text-indigo-highlight"></i>系统调用追踪器 (<code class="custom-inline-code">strace</code>, <code class="custom-inline-code">dtrace</code>)
                            </h4>
                            <p>当需要深入了解程序与操作系统的交互时，这些工具非常有用：</p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                <li><code class="custom-inline-code">strace</code> (Linux): 显示进程进行的系统调用和接收到的信号。可用于诊断文件访问、网络连接问题，或程序意外终止/挂起的原因。
                                    <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                        <li>常用法: <code class="custom-inline-code">strace -p &lt;PID&gt;</code>, <code class="custom-inline-code">strace -o out.txt -f ./program</code>, <code class="custom-inline-code">strace -e trace=open,read ./program</code></li>
                                    </ul>
                                </li>
                                <li><code class="custom-inline-code">dtrace</code> (macOS, BSD, Solaris): 功能更强大，使用 D 语言进行脚本化追踪。<code class="custom-inline-code">dtruss</code> 在 macOS 上提供了类似 strace 的接口。</li>
                                 <li><code class="custom-inline-code">bpftrace</code> (Linux): 基于 eBPF 的现代追踪工具，功能强大且开销较低。</li>
                            </ul>
                        </div>

                        <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fas fa-network-wired mr-2 text-indigo-highlight"></i>网络包分析器 (<code class="custom-inline-code">tcpdump</code>, <code class="custom-inline-code">Wireshark</code>)
                            </h4>
                            <p>用于捕获和分析网络流量，诊断网络通信问题：</p>
                             <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                <li><code class="custom-inline-code">tcpdump</code>: 强大的命令行抓包工具。
                                     <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                        <li>常用法: <code class="custom-inline-code">sudo tcpdump -i eth0 -w out.pcap</code>, <code class="custom-inline-code">sudo tcpdump -nn -X 'host example.com and port 443'</code></li>
                                    </ul>
                                </li>
                                <li><code class="custom-inline-code">Wireshark</code>: 图形化网络协议分析器，功能极其丰富，可以读取 <code class="custom-inline-code">tcpdump</code> 生成的文件。</li>
                                <li><code class="custom-inline-code">mitmproxy</code>: 交互式 HTTPS 代理，用于检查、修改、重放 HTTP/S 流量，调试 Web API 的利器。</li>
                            </ul>
                        </div>

                        <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fab fa-chrome mr-2 text-indigo-highlight"></i>Web 开发工具 (浏览器开发者工具)
                            </h4>
                            <p>现代浏览器内置的开发者工具 (通常按 <kbd>F12</kbd> 或右键点击 -> Inspect) 对于 Web 开发调试至关重要：</p>
                             <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                <li><strong class="font-bold">Elements/Inspector:</strong> 查看和实时编辑 HTML/CSS。</li>
                                <li><strong class="font-bold">Console:</strong> 查看日志、错误，执行 JavaScript。</li>
                                <li><strong class="font-bold">Sources/Debugger:</strong> 设置 JavaScript 断点、单步调试、检查变量。</li>
                                <li><strong class="font-bold">Network:</strong> 分析网络请求（时间、头、负载、状态码），过滤请求类型。</li>
                                <li><strong class="font-bold">Application/Storage:</strong> 检查 Cookies, Local Storage, Session Storage 等。</li>
                                <li><strong class="font-bold">Performance/Profiler:</strong> 记录和分析页面运行时性能，找出 JS 瓶颈。</li>
                                <li><strong class="font-bold">Lighthouse:</strong> (Chrome) 运行性能、可访问性、SEO 等方面的审计。</li>
                            </ul>
                        </div>

                    </div>
                 </div>
            </div>
            <!-- Static Analysis Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">静态分析 (Static Analysis)</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>静态分析工具可以在不实际运行代码的情况下检查代码，发现潜在错误、风格问题和安全漏洞。将这些工具集成到开发流程（如编辑器、CI/CD）中，可以显著提高代码质量和开发效率。</p>
                        
                        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Linters & Type Checkers -->
                            <div class="bg-slate-700 p-6 rounded-xl shadow-lg space-y-4">
                                <h4 class="font-sans-cn text-xl font-semibold text-moon-white flex items-center">
                                    <i class="fas fa-ruler-combined mr-2 text-indigo-highlight"></i>Linters (代码风格与质量检查)
                                </h4>
                                <p class="text-xs">检查代码风格、潜在错误和不良实践。</p>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                    <li>Python: <code class="custom-inline-code">Pylint</code>, <code class="custom-inline-code">Flake8</code>, <code class="custom-inline-code">Ruff</code> (极快)</li>
                                    <li>JS/TS: <code class="custom-inline-code">ESLint</code></li>
                                    <li>Shell: <code class="custom-inline-code">shellcheck</code></li>
                                    <li>Others: <code class="custom-inline-code">RuboCop</code> (Ruby), <code class="custom-inline-code">Checkstyle</code> (Java), <code class="custom-inline-code">clippy</code> (Rust)</li>
                                </ul>

                                <h4 class="font-sans-cn text-xl font-semibold text-moon-white mt-6 flex items-center">
                                    <i class="fas fa-check-double mr-2 text-indigo-highlight"></i>Type Checkers (类型检查)
                                </h4>
                                <p class="text-xs">验证代码中的类型一致性，提早发现类型错误。</p>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                    <li>Python: <code class="custom-inline-code">mypy</code>, <code class="custom-inline-code">pyright</code>, <code class="custom-inline-code">pytype</code></li>
                                    <li>JS: TypeScript (本身), <code class="custom-inline-code">Flow</code></li>
                                </ul>
                            </div>

                             <!-- Security, Formatters, Pre-commit -->
                             <div class="bg-slate-700 p-6 rounded-xl shadow-lg space-y-4">
                                <h4 class="font-sans-cn text-xl font-semibold text-moon-white flex items-center">
                                    <i class="fas fa-shield-alt mr-2 text-indigo-highlight"></i>Security Scanners (安全扫描)
                                </h4>
                                <p class="text-xs">识别潜在的安全漏洞。</p>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                     <li>Python: <code class="custom-inline-code">Bandit</code></li>
                                     <li>Dependencies: <code class="custom-inline-code">Snyk</code>, GitHub <code class="custom-inline-code">Dependabot</code></li>
                                     <li>General: SonarQube</li>
                                </ul>

                                <h4 class="font-sans-cn text-xl font-semibold text-moon-white mt-6 flex items-center">
                                    <i class="fas fa-align-left mr-2 text-indigo-highlight"></i>Code Formatters (代码格式化)
                                </h4>
                                <p class="text-xs">自动统一代码风格。</p>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                    <li>Python: <code class="custom-inline-code">Black</code>, <code class="custom-inline-code">autopep8</code>, <code class="custom-inline-code">YAPF</code></li>
                                    <li>Web: <code class="custom-inline-code">Prettier</code></li>
                                    <li>Go: <code class="custom-inline-code">gofmt</code></li>
                                    <li>Rust: <code class="custom-inline-code">rustfmt</code></li>
                                </ul>
                             </div>
                        </div>
                         
                        <div class="mt-8 bg-slate-700 p-6 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fas fa-code-branch mr-2 text-indigo-highlight"></i>Pre-commit Hooks (提交前检查)
                            </h4>
                            <p>使用 <a href="https://pre-commit.com/" target="_blank" class="text-indigo-highlight hover:underline">pre-commit</a> 框架可以在每次提交代码前自动运行 Linter, Formatter, Type Checker 甚至测试，强制保证代码库的质量和风格一致性。</p>
                            <details class="mt-3 bg-slate-700/80 p-3 rounded-lg ring-1 ring-slate-600">
                                 <summary class="cursor-pointer text-indigo-highlight/80 hover:text-indigo-highlight text-xs font-semibold">查看示例 <code class="custom-inline-code">.pre-commit-config.yaml</code></summary>
                                 <div class="pt-3 text-slate-300 text-xs space-y-2">
                                    <pre class="custom-code-block text-xs whitespace-pre-wrap"><code class="language-yaml">repos:
-   repo: https://github.com/psf/black
    rev: 23.3.0 # Use specific, stable versions
    hooks:
    -   id: black

-   repo: https://github.com/pycqa/flake8
    rev: 6.0.0
    hooks:
    -   id: flake8

-   repo: https://github.com/pre-commit/mirrors-mypy
    rev: 'v1.2.0'
    hooks:
    -   id: mypy
      # args: [--ignore-missing-imports] # Optional args for mypy</code></pre>
                                     <p>安装 pre-commit (<code class="custom-inline-code">pip install pre-commit</code>) 并在仓库根目录运行 <code class="custom-inline-code">pre-commit install</code> 即可启用。</p>
                                </div>
                            </details>
                        </div>

                    </div>
                 </div>
            </div>
            <!-- Profiling Intro & Timing Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">性能分析 (Profiling) - 基础</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>性能分析旨在帮助你理解程序的性能特征：它花费了多少时间？占用了多少内存？计算资源主要消耗在哪里（瓶颈）？</p>
                        <p class="font-semibold text-orange-400 italic"><i class="fas fa-quote-left mr-1"></i>"过早的优化是万恶之源 (Premature optimization is the root of all evil)" - Donald Knuth</p>
                        <p>在尝试优化代码之前，首先要通过性能分析找出真正的性能瓶颈所在。</p>

                        <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">计时 (Timing)</h3>
                        <p>测量代码执行时间是最基本的性能分析方法。</p>
                        <div class="mt-4 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-3 flex items-center"><i class="far fa-clock mr-2 text-indigo-highlight"></i>Wall Clock Time vs. CPU Time</h4>
                             <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                <li><strong class="font-bold">实际时间 (Real / Wall Clock Time):</strong> 代码执行实际流逝的时间。会受到系统中其他进程、I/O 等待等因素的影响。</li>
                                <li><strong class="font-bold">用户 CPU 时间 (User):</strong> CPU 在用户空间执行你的代码所花费的时间。</li>
                                <li><strong class="font-bold">系统 CPU 时间 (Sys):</strong> CPU 在内核空间为你的进程执行任务（如系统调用）所花费的时间。</li>
                                <li><code class="custom-inline-code">User + Sys</code> 时间更能反映你的程序实际消耗的 CPU 计算量。</li>
                             </ul>
                             <p class="text-xs text-slate-400 mt-2">Linux 的 <code class="custom-inline-code">time</code> 命令可以报告这三种时间: <code class="custom-inline-code">time ./my_program</code></p>
                        </div>
                         <div class="mt-6 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-3 flex items-center"><i class="fab fa-python mr-2 text-indigo-highlight"></i>Python <code class="custom-inline-code">time</code> 模块</h4>
                             <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                <li><code class="custom-inline-code">time.time()</code>: 获取 Wall Clock 时间（自 Epoch 以来的秒数），适合测量较长的时间间隔。</li>
                                <li><code class="custom-inline-code">time.perf_counter()</code>: 提供高精度计时器（单调递增），更适合用于对短代码片段进行基准测试。</li>
                                <li><code class="custom-inline-code">time.process_time()</code>: 返回当前进程的 User + Sys CPU 时间之和。</li>
                             </ul>
                         </div>
                    </div>
                 </div>
            </div>
            <!-- CPU Profilers Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">CPU 性能分析器</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>CPU 分析器帮助你识别程序中消耗最多 CPU 执行时间的部分（函数或代码行），从而找到优化的目标。</p>
                        
                        <div class="mt-6 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-3 flex items-center"><i class="fas fa-stopwatch mr-2 text-indigo-highlight"></i>Tracing vs. Sampling</h4>
                             <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                <li><strong class="font-bold">Tracing Profilers (追踪式):</strong> 记录每一次函数调用和返回。非常精确，但可能引入较大的性能开销，影响程序正常执行速度。</li>
                                <li><strong class="font-bold">Sampling Profilers (采样式):</strong> 按固定频率检查程序的调用栈。开销较低，对于运行时间较长的程序，结果在统计上具有代表性。</li>
                             </ul>
                        </div>

                        <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">Python CPU 分析器</h3>
                         <div class="mt-4 bg-slate-700 p-6 rounded-xl shadow-lg space-y-6">
                            <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fab fa-python mr-2"></i><code class="custom-inline-code">cProfile</code> (内置, Tracing)</h4>
                                <p class="text-xs mb-2">生成详细的函数调用统计信息。</p>
                                <pre class="custom-code-block text-xs"><code class="language-bash"># 运行并保存统计信息
python -m cProfile -o profile.stats my_script.py

# 使用 pstats 模块分析 (示例)
# python -c "import pstats; p=pstats.Stats('profile.stats'); p.sort_stats('cumulative').print_stats(20)"</code></pre>
                                <p class="text-xs text-slate-400 mt-1">可使用 <code class="custom-inline-code">snakeviz</code> 或 <code class="custom-inline-code">gprof2dot</code> + Graphviz 进行可视化。</p>
                            </div>
                             <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fab fa-python mr-2"></i><code class="custom-inline-code">line_profiler</code> (行级, Tracing)</h4>
                                <p class="text-xs mb-2">分析函数内部每行代码的执行时间。需要用 <code class="custom-inline-code">@profile</code> 装饰目标函数。</p>
                                <pre class="custom-code-block text-xs"><code class="language-bash">pip install line_profiler
kernprof -l -v my_script.py</code></pre>
                             </div>
                              <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fab fa-python mr-2"></i><code class="custom-inline-code">pyinstrument</code> (Sampling)</h4>
                                <p class="text-xs mb-2">采样分析器，开销较低，生成易于解读的交互式 HTML 报告 (包含火焰图)。</p>
                                <pre class="custom-code-block text-xs"><code class="language-bash">pip install pyinstrument
pyinstrument my_script.py</code></pre>
                             </div>
                             <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fab fa-python mr-2"></i><code class="custom-inline-code">Scalene</code> (Sampling, 高级)</h4>
                                <p class="text-xs mb-2">高性能 CPU 和内存分析器，能区分 Python/Native 代码耗时，并可分析 GPU 使用。</p>
                             </div>
                         </div>

                         <h4 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">其他语言常用 CPU 分析器</h4>
                         <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2 columns-2 gap-x-8">
                            <li>Java: JProfiler, YourKit, VisualVM</li>
                            <li>Go: <code class="custom-inline-code">pprof</code> (内置)</li>
                            <li>C/C++: <code class="custom-inline-code">gprof</code>, <code class="custom-inline-code">perf</code> (Linux), Valgrind (<code class="custom-inline-code">callgrind</code>)</li>
                            <li>Node.js: V8 profiler (<code class="custom-inline-code">node --prof</code>), Chrome DevTools</li>
                            <li>Browser JS: Chrome DevTools "Performance" tab</li>
                         </ul>
                    </div>
                 </div>
            </div>
            <!-- Memory Profilers Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">内存性能分析器</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>内存分析器帮助你识别程序中的内存泄漏（不再需要但未被释放的内存）或找出消耗过多内存的代码段。</p>
                        
                         <div class="mt-4 bg-slate-700 p-6 rounded-xl shadow-lg space-y-6">
                            <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fab fa-cuttlefish mr-2"></i>C/C++ 内存分析</h4>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                    <li><code class="custom-inline-code">Valgrind (memcheck)</code>: 检测内存错误的行业标准工具，能发现内存泄漏、无效读写等问题。</li>
                                </ul>
                            </div>
                             <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fab fa-python mr-2"></i>Python 内存分析</h4>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                     <li><code class="custom-inline-code">memory_profiler</code>: 逐行分析内存使用。需要 <code class="custom-inline-code">@profile</code> 装饰器。</li>
                                     <li><code class="custom-inline-code">tracemalloc</code> (内置, Python 3.4+): 追踪 Python 分配的内存块。可以创建快照并比较以定位内存增长。
                                          <details class="mt-2 bg-slate-700/80 p-3 rounded-lg ring-1 ring-slate-600">
                                              <summary class="cursor-pointer text-indigo-highlight/80 hover:text-indigo-highlight text-xs font-semibold">查看 tracemalloc 示例</summary>
                                              <div class="pt-3 text-slate-300 text-xs space-y-2">
                                                  <pre class="custom-code-block text-xs whitespace-pre-wrap"><code class="language-python">import tracemalloc

tracemalloc.start()

# ... code block 1 ...
snapshot1 = tracemalloc.take_snapshot()
# ... code block 2 ...
snapshot2 = tracemalloc.take_snapshot()

# 比较快照，找出内存分配增长最多的地方
top_stats = snapshot2.compare_to(snapshot1, 'lineno') 
print("[ Top 10 ]")
for stat in top_stats[:10]:
    print(stat)</code></pre>
                                              </div>
                                          </details>
                                     </li>
                                     <li><code class="custom-inline-code">objgraph</code>: 用于查找和可视化对象引用图，帮助理解为何某些对象没有被垃圾回收。</li>
                                      <li><code class="custom-inline-code">Scalene</code>: 也提供内存分析功能。</li>
                                </ul>
                             </div>
                              <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fab fa-java mr-2"></i>Java 内存分析</h4>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                     <li><code class="custom-inline-code">jmap</code> (命令行), VisualVM, Eclipse Memory Analyzer Tool (MAT)。</li>
                                </ul>
                             </div>
                         </div>
                    </div>
                 </div>
            </div>
            <!-- Event Profiling & Visualization Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">事件分析与可视化</h2>
                    <div class="space-y-8 text-slate-300 text-base leading-relaxed">
                        
                        <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                            <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fas fa-bolt mr-2 text-indigo-highlight"></i>事件分析 (<code class="custom-inline-code">perf</code>, eBPF)
                            </h4>
                            <p>事件分析器关注程序执行过程中的特定事件，如 CPU 周期、指令数、缓存未命中、系统调用等。</p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                <li><code class="custom-inline-code">perf</code> (Linux): 非常强大的系统级和进程级性能分析工具。
                                    <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                        <li><code class="custom-inline-code">perf list</code>: 查看可用的性能事件。</li>
                                        <li><code class="custom-inline-code">perf stat ./program</code>: 统计程序运行时的事件计数。</li>
                                        <li><code class="custom-inline-code">perf record -g ./program</code>: 记录性能数据（带调用图）。</li>
                                        <li><code class="custom-inline-code">perf report</code>: 分析 <code class="custom-inline-code">perf.data</code> 文件。</li>
                                    </ul>
                                </li>
                                <li><strong>eBPF (Extended Berkeley Packet Filter):</strong> Linux 内核技术，允许安全、高效地在内核运行自定义追踪代码。基于 eBPF 的工具（如 <code class="custom-inline-code">bcc</code> 工具集, <code class="custom-inline-code">bpftrace</code>）提供极其强大的低开销分析能力。</li>
                            </ul>
                        </div>

                        <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fas fa-chart-bar mr-2 text-indigo-highlight"></i>性能数据可视化
                            </h4>
                            <p>原始的性能分析数据往往信息量巨大且难以直接解读，可视化是理解性能瓶颈的关键。</p>
                             <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4 mt-2">
                                <li><strong class="font-bold">火焰图 (Flame Graphs):</strong> 由 Brendan Gregg 推广，非常适合可视化 CPU 采样数据。Y 轴代表调用栈深度，X 轴宽度代表函数占用的时间比例。可以快速识别出消耗 CPU 最多的代码路径。
                                    <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                        <li>生成工具: <code class="custom-inline-code">flamegraph.pl</code>, <code class="custom-inline-code">pyinstrument</code> (内置HTML), Go <code class="custom-inline-code">pprof</code>。</li>
                                    </ul>
                                </li>
                                <li><strong class="font-bold">调用图 (Call Graphs):</strong> 将函数表示为节点，函数间的调用表示为边。可以标注调用次数或时间占比。
                                    <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                        <li>生成工具: Python <code class="custom-inline-code">pycallgraph</code>, <code class="custom-inline-code">gprof2dot</code> (转换 cProfile 等输出为 dot 格式) + Graphviz。</li>
                                    </ul>
                                </li>
                                <li><strong class="font-bold">IDE 集成:</strong> 许多 IDE 的性能分析工具都提供了内置的可视化功能（如调用树、火焰图）。</li>
                            </ul>
                        </div>

                    </div>
                 </div>
            </div>
            <!-- Resource Monitoring Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">资源监控 (Resource Monitoring)</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>除了针对特定代码段进行深入分析，实时或历史地监控系统整体资源使用情况对于理解程序行为和诊断问题同样重要。</p>
                        
                        <div class="mt-6 bg-slate-700 p-6 rounded-xl shadow-lg">
                            <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-4">常用监控工具分类</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                <!-- Column 1 -->
                                <div class="space-y-4">
                                    <div>
                                        <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-tachometer-alt mr-1"></i>通用监控</h5>
                                        <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                            <li><code class="custom-inline-code">top</code> / <code class="custom-inline-code">htop</code></li>
                                            <li><code class="custom-inline-code">btop++</code> / <code class="custom-inline-code">bpytop</code></li>
                                            <li><code class="custom-inline-code">glances</code></li>
                                            <li><code class="custom-inline-code">dstat</code></li>
                                            <li><code class="custom-inline-code">vmstat</code></li>
                                        </ul>
                                    </div>
                                     <div>
                                        <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-exchange-alt mr-1"></i>I/O 操作</h5>
                                        <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                             <li><code class="custom-inline-code">iotop</code></li>
                                             <li><code class="custom-inline-code">iostat</code></li>
                                        </ul>
                                    </div>
                                     <div>
                                        <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-hdd mr-1"></i>磁盘使用</h5>
                                         <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                             <li><code class="custom-inline-code">df -h</code></li>
                                             <li><code class="custom-inline-code">du -sh *</code></li>
                                             <li><code class="custom-inline-code">ncdu</code> (交互式)</li>
                                        </ul>
                                    </div>
                                </div>
                                <!-- Column 2 -->
                                <div class="space-y-4">
                                   <div>
                                        <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-memory mr-1"></i>内存使用</h5>
                                         <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                             <li><code class="custom-inline-code">free -h</code></li>
                                             <li><code class="custom-inline-code">vmstat</code></li>
                                        </ul>
                                    </div>
                                     <div>
                                        <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-folder-open mr-1"></i>打开的文件</h5>
                                         <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                             <li><code class="custom-inline-code">lsof</code> (非常强大)</li>
                                        </ul>
                                    </div>
                                     <div>
                                        <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-network-wired mr-1"></i>网络连接/配置</h5>
                                         <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                             <li><code class="custom-inline-code">ss</code> (替代 netstat)</li>
                                             <li><code class="custom-inline-code">ip</code> (替代 ifconfig)</li>
                                             <li><code class="custom-inline-code">netstat</code> (旧)</li>
                                             <li><code class="custom-inline-code">ifconfig</code> (旧)</li>
                                        </ul>
                                    </div>
                                </div>
                                 <!-- Column 3 -->
                                <div class="space-y-4">
                                     <div>
                                        <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-wifi mr-1"></i>网络使用</h5>
                                        <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                             <li><code class="custom-inline-code">nethogs</code> (按进程)</li>
                                             <li><code class="custom-inline-code">iftop</code> (按接口)</li>
                                        </ul>
                                    </div>
                                     <div>
                                        <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-weight-hanging mr-1"></i>压力测试</h5>
                                        <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                            <li><code class="custom-inline-code">stress</code> / <code class="custom-inline-code">stress-ng</code></li>
                                        </ul>
                                    </div>
                                     <div>
                                        <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-chart-line mr-1"></i>长期监控</h5>
                                         <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                             <li>Prometheus + Grafana</li>
                                             <li>ELK, Loki, Splunk, Datadog 等</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                 </div>
            </div>
                        <!-- Benchmarking Card -->
                        <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                            <div class="p-6 md:p-8">
                               <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">基准测试 (Benchmarking)</h2>
                               <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                                   <p>基准测试专注于精确测量和比较特定代码片段或命令的性能。这对于评估优化效果或比较不同实现的性能非常重要。</p>
                                   
                                   <div class="mt-6 bg-slate-700 p-6 rounded-xl shadow-lg">
                                        <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-4">常用基准测试工具</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <!-- Column 1: General & Language Specific -->
                                           <div class="space-y-4">
                                               <div>
                                                   <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-stopwatch-20 mr-1"></i>命令行工具</h5>
                                                   <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                                        <li><code class="custom-inline-code">hyperfine</code>: 优秀的命令行基准测试工具，可以方便地比较多个命令的执行时间。</li>
                                                   </ul>
                                               </div>
                                                <div>
                                                   <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fab fa-python mr-1"></i>Python</h5>
                                                    <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                                        <li><code class="custom-inline-code">timeit</code> 模块: 用于精确测量小代码片段的执行时间。</li>
                                                        <li><code class="custom-inline-code">pytest-benchmark</code>: 将基准测试集成到 pytest 测试框架中。</li>
                                                   </ul>
                                               </div>
                                               <div>
                                                   <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fab fa-golang mr-1"></i>Go</h5>
                                                    <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                                        <li><code class="custom-inline-code">testing</code> 包: 内置基准测试支持 (<code class="custom-inline-code">go test -bench=.</code>)。</li>
                                                   </ul>
                                               </div>
                                                <div>
                                                   <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fab fa-rust mr-1"></i>Rust</h5>
                                                   <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                                        <li><code class="custom-inline-code">cargo bench</code>: 内置基准测试命令。</li>
                                                        <li>Criterion.rs: 流行的基准测试库。</li>
                                                   </ul>
                                               </div>
                                           </div>
                                            <!-- Column 2: Web Performance -->
                                           <div>
                                               <h5 class="font-semibold text-indigo-highlight/90 mb-1"><i class="fas fa-globe mr-1"></i>Web 性能</h5>
                                               <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                                   <li>浏览器开发者工具 ("Performance", "Lighthouse" tabs)。</li>
                                                   <li><a href="https://www.webpagetest.org/" target="_blank" class="text-indigo-highlight hover:underline">WebPageTest.org</a>: 详细的在线网站性能分析。</li>
                                                   <li>负载测试工具 (模拟大量用户访问): 
                                                       <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-5 mt-1">
                                                           <li><code class="custom-inline-code">k6.io</code></li>
                                                           <li>Apache <code class="custom-inline-code">JMeter</code></li>
                                                           <li><code class="custom-inline-code">Locust</code> (Python)</li>
                                                       </ul>
                                                   </li>
                                               </ul>
                                           </div>
                                        </div>
                                   </div>
                               </div>
                            </div>
                       </div>
             <!-- Exercises Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">练习 (Exercises)</h2>
                    <ol class="list-decimal list-inside space-y-8 text-slate-300 text-sm pl-4">
                        
                        <li class="pt-6 border-t border-slate-700">
                            <p>使用 <code class="custom-inline-code">journalctl</code> (Linux) 或 <code class="custom-inline-code">log show</code> (macOS) 查找你上次使用 <code class="custom-inline-code">sudo</code> 执行命令的时间和具体命令。</p>
                             <details class="mt-3 bg-slate-700 p-3 rounded-lg">
                                <summary class="cursor-pointer text-indigo-highlight/80 hover:text-indigo-highlight text-xs font-semibold">查看解答提示</summary>
                                <div class="pt-3 text-slate-300 text-xs space-y-2">
                                    <p>Linux:</p>
                                    <pre class="custom-code-block text-xs whitespace-pre-wrap"><code class="language-bash"># journalctl 通常记录 sudo 活动
journalctl _COMM=sudo | grep 'COMMAND=' | tail -n 1 
# 或者检查 auth.log
# grep sudo /var/log/auth.log | tail -n 1</code></pre>
                                     <p>macOS:</p>
                                    <pre class="custom-code-block text-xs whitespace-pre-wrap"><code class="language-bash"># log show 可能记录在 system.log 或通过特定谓词
log show --last 1d --predicate 'process == "sudo" and eventMessage contains "COMMAND="'
# (具体谓词可能需要调整)</code></pre>
                                </div>
                            </details>
                        </li>

                        <li class="pt-6 border-t border-slate-700">
                            <p>阅读 <code class="custom-inline-code">pdb</code> 的教程 (例如 <a href="https://realpython.com/python-debugging-pdb/" target="_blank" class="text-indigo-highlight hover:underline">这个</a>) 并尝试使用 <code class="custom-inline-code">pdb</code> 或 <code class="custom-inline-code">ipdb</code> 调试一个简单的 Python 脚本。尝试设置断点、单步执行、打印变量值。</p>
                            <!-- No specific answer hint needed -->
                        </li>

                        <li class="pt-6 border-t border-slate-700">
                            <p>运行 <code class="custom-inline-code">shellcheck</code> 来检查这个有问题的脚本，并修复其中的错误。</p>
                             <pre class="custom-code-block text-xs mt-2"><code class="language-bash">#!/bin/sh
# Example: a typical script with several problems

for f in $(ls *.m3u)
do
  grep -qi hq.*mp3 $f \
    && echo -e 'Playlist $f contains a HQ file in mp3 format'
done</code></pre>
                              <details class="mt-3 bg-slate-700 p-3 rounded-lg">
                                <summary class="cursor-pointer text-indigo-highlight/80 hover:text-indigo-highlight text-xs font-semibold">查看解答提示 (修正后的脚本)</summary>
                                <div class="pt-3 text-slate-300 text-xs space-y-2">
                                    <pre class="custom-code-block text-xs whitespace-pre-wrap"><code class="language-bash">#!/bin/sh
# shellcheck disable=SC2035 # Optional: disable glob warning if files are guaranteed simple
# Corrected script
for f in *.m3u; do # Use globbing directly
  # Quote filename for grep and check exit status explicitly
  if grep -qi 'hq.*mp3' "$f"; then 
    # Use double quotes for variable expansion
    echo "Playlist '$f' contains a HQ file in mp3 format"
  fi
done

# Alternative using find (more robust for complex filenames/subdirs):
# find . -maxdepth 1 -name "*.m3u" -print0 | while IFS= read -r -d $'\0' f; do
#   if grep -qi 'hq.*mp3' "$f"; then
#     echo "Playlist '$f' contains a HQ file in mp3 format"
#   fi
# done</code></pre>
                                     <p><code class="custom-inline-code">shellcheck</code> 会指出：1) 不应解析 <code class="custom-inline-code">ls</code> 输出；2) <code class="custom-inline-code">$f</code> 未加引号可能导致 word splitting；3) 单引号阻止 <code class="custom-inline-code">$f</code> 变量扩展。</p>
                                </div>
                            </details>
                        </li>
                        
                        <li class="pt-6 border-t border-slate-700">
                            <p>(高级) 了解可逆调试器 (reversible debugger)，例如 <code class="custom-inline-code">rr</code> (Linux) 或查看 <code class="custom-inline-code">RevPDB</code>。它们与传统调试器有何不同？</p>
                             <details class="mt-3 bg-slate-700 p-3 rounded-lg">
                                <summary class="cursor-pointer text-indigo-highlight/80 hover:text-indigo-highlight text-xs font-semibold">查看解答提示</summary>
                                <div class="pt-3 text-slate-300 text-xs space-y-2">
                                    <p>主要区别在于可逆调试器允许你<strong>向后执行</strong>代码（例如 "reverse-step", "reverse-continue"），而不仅仅是向前执行。这对于追踪复杂 bug 的根源非常有用，因为你可以回溯到错误发生前的状态。传统调试器通常只能重新运行到断点。</p>
                                    <p><code class="custom-inline-code">rr</code> 通过记录程序的非确定性执行部分，然后允许在确定性的重放过程中任意前后移动。</p>
                                </div>
                            </details>
                        </li>

                        <li class="pt-6 border-t border-slate-700">
                            <p>使用 <code class="custom-inline-code">time</code> 命令或 Python 的 <code class="custom-inline-code">time.perf_counter()</code> / <code class="custom-inline-code">time.process_time()</code> 比较插入排序和快速排序（或你选择的两种排序算法）在小列表和大列表上的性能差异。分析 User time 和 Sys time。</p>
                            <!-- No specific answer hint needed, involves coding and timing -->
                        </li>
                        
                        <li class="pt-6 border-t border-slate-700">
                            <p>使用 Python 的 <code class="custom-inline-code">cProfile</code> 和 <code class="custom-inline-code">line_profiler</code> 分析一个递归计算斐波那契数列的函数。找出性能瓶颈。然后使用 <code class="custom-inline-code">functools.lru_cache</code> (或手动实现 memoization) 进行优化，并再次分析，比较结果。</p>
                            <!-- No specific answer hint needed, involves profiling a specific function -->
                        </li>

                        <li class="pt-6 border-t border-slate-700">
                            <p>使用 <code class="custom-inline-code">lsof</code> 找出你的浏览器当前打开了哪些文件。再找出监听端口 8080 (或你选择的其他端口) 的进程 (如果存在)。</p>
                             <details class="mt-3 bg-slate-700 p-3 rounded-lg">
                                <summary class="cursor-pointer text-indigo-highlight/80 hover:text-indigo-highlight text-xs font-semibold">查看解答提示</summary>
                                <div class="pt-3 text-slate-300 text-xs space-y-2">
                                    <pre class="custom-code-block text-xs whitespace-pre-wrap"><code class="language-bash"># 查找浏览器进程 ID (以 Chrome 为例，进程名可能不同)
pgrep -a chrome 
# 假设找到 PID <browser_pid>
lsof -p <browser_pid>

# 查找监听 8080 端口的进程
sudo lsof -i :8080 -sTCP:LISTEN
# 或者使用 ss
# sudo ss -tulnp | grep 8080</code></pre>
                                </div>
                            </details>
                        </li>

                        <li class="pt-6 border-t border-slate-700">
                            <p>(高级, Linux) 使用 <code class="custom-inline-code">stress -c 3</code> 启动 3 个 CPU 密集型进程。然后使用 <code class="custom-inline-code">taskset --cpu-list 0,2 stress -c 3</code> 将它们限制在 CPU 核心 0 和 2 上运行。观察 <code class="custom-inline-code">htop</code> 或类似工具中 CPU 使用率的变化。</p>
                             <!-- No specific answer hint needed, involves observing system tools -->
                        </li>
                        
                        <li class="pt-6 border-t border-slate-700">
                            <p>使用 <code class="custom-inline-code">Wireshark</code> 或 <code class="custom-inline-code">sudo tcpdump -nn -A 'host ipinfo.io'</code> 捕获执行 <code class="custom-inline-code">curl ipinfo.io</code> 时的网络流量。查看 DNS 查询、TCP 连接和 HTTP(S) 请求/响应过程。</p>
                             <details class="mt-3 bg-slate-700 p-3 rounded-lg">
                                <summary class="cursor-pointer text-indigo-highlight/80 hover:text-indigo-highlight text-xs font-semibold">查看解答提示</summary>
                                <div class="pt-3 text-slate-300 text-xs space-y-2">
                                    <p>你可能会看到：</p>
                                    <ol class="list-decimal list-inside text-xs">
                                        <li>DNS 查询请求 `ipinfo.io` 的 IP 地址。</li>
                                        <li>DNS 响应。</li>
                                        <li>与服务器 IP 的 TCP 三次握手 (SYN, SYN-ACK, ACK) 建立连接 (通常是 80 或 443 端口)。</li>
                                        <li>如果端口是 443 (HTTPS)，接下来是 TLS 握手过程。</li>
                                        <li>(加密的) HTTP 请求发送到服务器。</li>
                                        <li>(加密的) HTTP 响应从服务器返回。</li>
                                        <li>TCP 连接终止 (FIN, ACK 等)。</li>
                                    </ol>
                                    <p>(<code class="custom-inline-code">-nn</code> 禁用名称解析，<code class="custom-inline-code">-A</code> 显示 ASCII 内容)</p>
                                </div>
                            </details>
                        </li>

                    </ol>
                </div>
            </div>
        </div>

        <!-- 导航 -->
        <nav class="mt-16 flex justify-between items-center">
            <a href="lecture-6.html" class="px-6 py-3 text-indigo-highlight hover:bg-indigo-highlight/10 rounded-md font-sans-cn">
                &larr; 上一单元 (版本控制 Git)
            </a>
            <a href="lecture-8.html" class="px-6 py-3 text-indigo-highlight hover:bg-indigo-highlight/10 rounded-md font-sans-cn">
                下一单元 (元编程) &rarr;
            </a>
        </nav>
    </main>

    <footer class="mt-20 py-10 bg-slate-800 border-t border-slate-700 text-center">
        <p class="font-sans-cn text-slate-400">
            &copy; 2025 Missing Semester 中文版. 基于 MIT 原始课程.
        </p>
        <p class="font-sans-en text-slate-500 text-sm mt-2">
            <a href="https://missing.csail.mit.edu/" target="_blank" class="hover:text-indigo-highlight">原始课程链接</a> | 
            <a href="https://github.com/huashanjian/CN-the-missing-semester.git" class="hover:text-indigo-highlight">GitHub 仓库</a>
        </p>
        <p class="font-sans-cn text-slate-400 text-sm mt-2">
            由 <a href="https://huashanjian.github.io/" target="_blank" class="hover:text-indigo-highlight">Junhua Yao</a> 创建和维护
        </p>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/framer-motion@latest/dist/framer-motion.js"></script>
    <script>
        // Placeholder for Framer Motion scripts
    </script>
    <!-- Add PrismJS script (needs to be after content) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html> 