<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>安全与密码学 - 计算机的缺失课程</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'moon-white': '#F5F5F5',
              'sky-blue-tint': '#F0F9FF',
              'silver-rat-grey': '#E5E7EB',
              'ink-black': '#111827',
              'crow-blue': '#1E40AF',
              'medium-grey': '#6B7280',
              'indigo-highlight': '#0EA5E9',
            },
            fontFamily: {
              'sans-cn': ['"Source Han Sans SC"', 'PingFang SC', 'sans-serif'],
              'sans-en': ['Inter', 'Manrope', 'sans-serif'],
            }
          }
        }
      }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Manrope:wght@400;700&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    <!-- Add MathJax script for formula rendering -->
    <script>
    MathJax = {
      tex: {
        inlineMath: [['\\\\(', '\\\\)']],  // Double backslash for escaping
        displayMath: [['\\\\[', '\\\\]']]  // Double backslash for escaping
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
    </script>
    <style>
      body { font-family: theme('fontFamily.sans-cn'); }
      .font-sans-en { font-family: theme('fontFamily.sans-en'); }
      .font-sans-cn { font-family: theme('fontFamily.sans-cn'); }
      pre[class*="language-"], .custom-code-block { background-color: #1E293B; color: #E2E8F0; padding: theme('spacing.6'); border-radius: theme('borderRadius.xl'); overflow-x: auto; margin-top: theme('spacing.4'); margin-bottom: theme('spacing.6'); }
      code:not(pre code), .custom-inline-code { background-color: theme('colors.slate.700'); color: theme('colors.slate.200'); padding: theme('spacing.1') theme('spacing.2'); border-radius: theme('borderRadius.md'); font-size: 0.9em; }
      kbd { background-color: theme('colors.slate.600'); color: theme('colors.slate.100'); padding: theme('spacing.px') theme('spacing.1'); border-radius: theme('borderRadius.md'); font-family: theme('fontFamily.mono'); font-size: 0.85em; border: 1px solid theme('colors.slate.500'); box-shadow: 1px 1px 1px theme('colors.slate.900'); }
    </style>
</head>
<body class="bg-slate-900 text-slate-200"> 

    <header class="py-4 shadow-lg sticky top-0 bg-slate-800/90 backdrop-blur-md z-50 border-b border-slate-700">
        <nav class="container mx-auto px-6 md:px-8 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold font-sans-cn">
                <span class="text-moon-white">缺失</span><span class="text-indigo-highlight">环节</span>
            </a>
            <div>
                <a href="index.html#bento-grid" class="font-sans-cn text-slate-300 hover:text-indigo-highlight ml-6">课程列表</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        <section class="mb-12 pt-8 text-center">
            <h1 class="font-sans-cn font-bold text-5xl md:text-7xl text-moon-white mb-2">
                安全与密码学
            </h1>
            <p class="font-sans-en text-lg md:text-xl text-medium-grey">
                 Security and Cryptography
            </p>
        </section>

        <div class="space-y-8 md:space-y-12">
            <!-- Introduction & Disclaimer -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden border border-red-500/50">
                <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-red-400 mb-6 text-center flex items-center justify-center">
                        <i class="fas fa-exclamation-triangle mr-3"></i>重要声明与课程目标
                    </h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>本讲座旨在帮助理解之前课程中涉及工具（如 Git 的哈希，SSH 的密钥和加密）所使用的安全与密码学基础概念，并非系统性的安全或密码学课程。</p>
                        <p class="font-semibold text-red-400">请务必注意：</p>
                         <ul class="list-disc list-inside space-y-1 text-red-400/90 text-sm pl-4">
                            <li>本讲座内容不足以指导你设计安全系统或密码协议。</li>
                            <li><strong class="font-bold">没有经过正规的安全培训，请勿从事安全相关的工作。</strong></li>
                            <li><strong class="font-bold">除非你是该领域的专家，否则绝对不要自己实现加密算法或安全协议 ("Don't roll your own crypto")。</strong></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Entropy Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">熵 (Entropy) 与密码强度</h2>
                     <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p><strong class="font-bold">熵 (Entropy)</strong> 是衡量随机性或不可预测性的度量单位，通常以"比特 (bits)"计。它对于评估密码强度非常有用。</p>
                        <p>从 N 个等可能的结果中随机选择一个，其熵为 \\( \log_2(N) \\) 比特。</p>
                         <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                             <li class="flex items-baseline space-x-1">
                                <span>抛一次硬币的熵:</span>
                                <span>\\( \log_2(2) = 1 \\)</span>
                                <span>比特。</span>
                            </li>
                            <li class="flex items-baseline space-x-1">
                                <span>掷一次六面骰子的熵:</span>
                                <span>\\( \log_2(6) \approx 2.58 \\)</span>
                                <span>比特。</span>
                            </li>
                         </ul>
                         
                         <div class="my-6 flex justify-center">
                            <a href="https://xkcd.com/936/" target="_blank">
                                <img src="https://imgs.xkcd.com/comics/password_strength.png" alt="XKCD Comic 936: Password Strength" class="rounded-lg shadow-md max-w-md mx-auto">
                                <p class="text-center text-xs text-slate-400 mt-2">XKCD #936: 密码强度</p>
                            </a>
                        </div>
                        
                        <p>如 XKCD 漫画所示，由多个普通单词组成的<strong class="font-bold">密码短语 (passphrase)</strong>（如 "correcthorsebatterystaple"）通常比短而复杂的密码（如 "Tr0ub4dor&3"）具有更高的熵，因此更安全，同时也更容易记忆。</p>
                        <p>评估密码强度时，需要考虑<strong class="font-bold">威胁模型 (threat model)</strong>：</p>
                         <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                             <div class="bg-slate-700 p-4 rounded-xl shadow-lg">
                                <h4 class="font-semibold text-moon-white mb-2"><i class="fas fa-network-wired mr-1"></i>在线猜测</h4>
                                <p class="text-xs">攻击者通过网络服务尝试密码，受速率限制。约 40 比特熵通常足够（XKCD 例子约 44 比特）。</p>
                             </div>
                             <div class="bg-slate-700 p-4 rounded-xl shadow-lg">
                                 <h4 class="font-semibold text-moon-white mb-2"><i class="fas fa-server mr-1"></i>离线猜测</h4>
                                 <p class="text-xs">攻击者获得密码哈希库，可在本地高速破解。需要更高熵，如 80+ 比特。</p>
                             </div>
                         </div>

                        <h4 class="font-sans-cn text-lg font-semibold text-moon-white mt-6 mb-3"><i class="fas fa-lightbulb mr-1 text-indigo-highlight"></i>实用技巧</h4>
                         <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                            <li>使用 Diceware 等方法生成基于随机单词的密码短语。</li>
                            <li><strong class="font-bold">使用密码管理器！</strong> 为每个网站生成并存储独特、高熵的随机密码是最佳实践。</li>
                         </ul>
                    </div>
                </div>
            </div>
             <!-- Hash Functions Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">哈希函数 (Hash Functions)</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>密码学哈希函数是一种特殊的数学函数，它接收任意大小的输入数据，并生成一个固定大小的输出，称为<strong class="font-bold">哈希值 (hash value)</strong> 或 <strong class="font-bold">摘要 (digest)</strong>。</p>
                        <pre class="custom-code-block text-sm"><code class="language-text">hash(value:任意字节数组) -> 固定长度N的字节向量</code></pre>
                        <p>例如，Git 中使用的 SHA-1 算法将任意输入映射为 160 比特（通常显示为 40 个十六进制字符）的输出。</p>
                        <pre class="custom-code-block"><code class="language-bash">$ printf 'hello' | sha1sum
aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d  -

$ printf 'Hello' | sha1sum # 输入改变，哈希值完全不同
f7ff9e8b7bb2e09b70935a5d785e0cc5d9d0abf0  -</code></pre>
                         
                        <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">理想的密码学哈希函数特性</h3>
                         <div class="mt-4 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <ol class="list-decimal list-inside space-y-1 text-slate-300 text-sm pl-4">
                                <li><strong class="font-bold">确定性 (Deterministic):</strong> 相同输入永远产生相同输出。</li>
                                <li><strong class="font-bold">抗原像攻击 (Preimage Resistant):</strong> 给定哈希值 `h`，难以找到输入 `m` 使得 `hash(m) = h`。（单向性）</li>
                                <li><strong class="font-bold">抗第二原像攻击 (Second Preimage Resistant):</strong> 给定输入 `m1`，难以找到另一个不同输入 `m2` 使得 `hash(m1) = hash(m2)`。</li>
                                <li><strong class="font-bold">抗碰撞攻击 (Collision Resistant):</strong> 难以找到任意两个不同的输入 `m1` 和 `m2` 使得 `hash(m1) = hash(m2)`。（这是最强的要求）</li>
                             </ol>
                         </div>
                         <p class="mt-4 text-orange-400"><i class="fas fa-exclamation-triangle mr-1"></i><strong class="font-bold">注意:</strong> SHA-1 已被证明存在实际的碰撞攻击，不再安全！推荐使用 SHA-2 (SHA-256, SHA-512), SHA-3 或 BLAKE2/3 系列。选择哈希函数需专业知识。</p>
                         <p class="text-xs text-slate-400">常用命令: <code class="custom-inline-code">sha256sum</code>, <code class="custom-inline-code">sha512sum</code>, <code class="custom-inline-code">b2sum</code>。</p>

                         <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">哈希函数应用场景</h3>
                          <div class="mt-4 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4">
                                <li><strong class="font-bold">Git 内容寻址:</strong> 使用 SHA-1 (未来可能迁移) 哈希值作为对象 ID，抗碰撞性保证仓库完整性。</li>
                                <li><strong class="font-bold">文件完整性校验:</strong> 下载文件后计算哈希值与官方发布的比对，确保未被篡改。</li>
                                <li><strong class="font-bold">承诺方案 (Commitment Schemes):</strong> 先公布一个值的哈希，稍后再揭示该值，用于证明承诺未被更改（如在线抛硬币）。</li>
                                <li><strong class="font-bold">密码存储 (配合盐):</strong> 与 KDF 结合使用，安全地存储密码凭证（见下节）。</li>
                             </ul>
                         </div>
                    </div>
                 </div>
            </div>
             <!-- KDFs Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">密钥派生函数 (KDFs)</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>密钥派生函数 (KDFs) 与密码学哈希函数相关，但其设计目标不同。KDF 用于从一个秘密值（如密码或密码短语）安全地派生出一个或多个用于其他密码学操作的密钥。</p>
                        <p>KDF 的一个关键特性是它们通常被设计成<strong class="font-bold">故意缓慢</strong>且消耗大量计算资源（CPU 时间、内存），目的是增加<strong class="font-bold">离线暴力破解</strong>的难度和成本。</p>

                         <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">常见的 KDFs</h3>
                          <div class="mt-4 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                <li><strong class="font-bold">Argon2:</strong> 密码哈希竞赛 (PHC) 获胜者，现代推荐标准。可配置时间、内存成本和并行度。</li>
                                <li><strong class="font-bold">scrypt:</strong> 需要大量内存，能有效抵抗 GPU/ASIC 攻击。</li>
                                <li><strong class="font-bold">bcrypt:</strong> 基于 Blowfish，历史悠久，经过广泛审查。</li>
                                <li><strong class="font-bold">PBKDF2:</strong> 广泛使用的标准，但相对前三者，抵抗定制硬件攻击的能力较弱。</li>
                             </ul>
                         </div>

                         <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">KDF 应用场景</h3>
                          <div class="mt-4 bg-slate-700 p-6 rounded-xl shadow-lg space-y-6">
                             <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fas fa-key mr-2"></i>从密码短语生成密钥</h4>
                                <p class="text-xs">将用户易记的密码短语转换为适用于对称加密等算法的固定长度、高熵密钥。</p>
                            </div>
                            <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fas fa-user-shield mr-2"></i>安全存储用户密码凭证</h4>
                                <p class="text-xs text-red-500 font-bold mb-2"><i class="fas fa-times-circle mr-1"></i>绝对禁止明文存储密码！</p>
                                <p class="text-xs mb-2">仅存储密码的哈希值（无盐）也不够安全，容易受到彩虹表攻击。</p>
                                <h5 class="font-semibold text-emerald-400 mb-2 text-sm">正确做法 (加盐 KDF):</h5>
                                <ol class="list-decimal list-inside space-y-1 text-slate-300 text-xs pl-4">
                                    <li>为每个用户生成一个<strong class="font-bold">唯一的、随机的盐 (salt)</strong>。</li>
                                    <li>使用 KDF 计算派生密钥: <code class="custom-inline-code">derived_key = KDF(password, salt, cost_parameters...)</code></li>
                                    <li>在数据库中存储用户的 <code class="custom-inline-code">user_id</code>, <code class="custom-inline-code">salt</code>, <code class="custom-inline-code">derived_key</code> 以及 KDF 使用的<code class="custom-inline-code">参数</code> (如迭代次数、内存成本)。</li>
                                    <li>用户登录时：获取用户的 salt 和参数，用输入的密码重新计算 KDF，将结果与存储的 derived_key 比较。</li>
                                </ol>
                                <p class="text-xs text-slate-400 mt-2"><strong class="font-bold">盐 (Salt) 的作用:</strong> 确保即使多个用户使用相同密码，他们存储的派生密钥也不同，从而使预计算哈希表（彩虹表）失效。</p>
                            </div>
                         </div>
                    </div>
                 </div>
            </div>
            <!-- Symmetric Cryptography Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">对称加密 (Symmetric Cryptography)</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>对称加密是最符合我们对"加密"直觉理解的技术：使用一个<strong class="font-bold">密钥 (key)</strong> 来加密<strong class="font-bold">明文 (plaintext)</strong> 得到<strong class="font-bold">密文 (ciphertext)</strong>，并使用<strong class="font-bold">相同的密钥</strong>将密文解密回明文。</p>
                        <pre class="custom-code-block text-sm"><code class="language-pseudocode">keygen() -> key // 随机生成密钥
encrypt(plaintext, key) -> ciphertext
decrypt(ciphertext, key) -> plaintext

// 正确性: decrypt(encrypt(plaintext, key), key) == plaintext</code></pre>
                        <p>核心安全属性是：在不知道密钥的情况下，很难从密文推断出明文。</p>
                        <p>目前广泛使用的对称加密标准是 <strong class="font-bold">AES (Advanced Encryption Standard)</strong>，通常使用 128, 192 或 256 位密钥。</p>
                        
                        <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">重要概念：工作模式与 IV/Nonce</h3>
                         <div class="mt-4 bg-slate-700 p-6 rounded-xl shadow-lg space-y-6">
                            <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fas fa-cogs mr-2"></i>工作模式 (Modes of Operation)</h4>
                                <p class="text-xs mb-2">像 AES 这样的块密码一次只能处理固定大小（如 128 比特）的数据块。为了加密更长的消息，需要一种工作模式：</p>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                    <li>ECB: <strong class="text-red-500">不安全，绝不应使用</strong> (相同明文块产生相同密文块)。</li>
                                    <li>CBC, CTR: 常用模式，但需要额外进行消息认证。</li>
                                    <li><strong class="font-bold text-emerald-400">GCM (Galois/Counter Mode):</strong> AEAD (认证加密) 模式，同时提供<strong class="font-bold">机密性</strong>、<strong class="font-bold">完整性</strong>和<strong class="font-bold">真实性</strong>。<strong class="font-bold text-emerald-400">强烈推荐使用 AEAD 模式。</strong></li>
                                </ul>
                            </div>
                             <div>
                                <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-2"><i class="fas fa-key mr-2"></i>初始化向量 (IV) / Nonce</h4>
                                <p class="text-xs mb-2">为了让相同的明文用相同密钥加密时能产生不同的密文（防止模式泄露），大多数工作模式需要一个<strong class="font-bold">初始化向量 (IV)</strong> 或 <strong class="font-bold">Nonce (Number used once)</strong>。</p>
                                <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs pl-4">
                                    <li>IV/Nonce 对于每次加密（使用相同密钥时）<strong class="font-bold">必须是唯一的</strong> (通常是随机生成或基于计数器)。</li>
                                    <li>它不需要保密，通常和密文一起传输。</li>
                                    <li class="text-red-500 font-bold"><i class="fas fa-exclamation-triangle mr-1"></i>绝对禁止重复使用相同的 (密钥, IV/Nonce) 组合来加密不同的消息！这会破坏安全性。</li>
                                </ul>
                             </div>
                         </div>

                         <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">对称加密应用场景</h3>
                          <div class="mt-4 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4">
                                <li><strong class="font-bold">文件加密:</strong> 使用 KDF 从密码派生密钥，然后用 AES-GCM 等加密文件，存储密文和 IV/Nonce。</li>
                                <li><strong class="font-bold">安全通信中的数据传输:</strong> 例如 HTTPS (TLS) 连接建立后，通信双方会协商一个临时的对称会话密钥，用于快速加密后续传输的大量数据。</li>
                             </ul>
                         </div>
                    </div>
                 </div>
            </div>
            <!-- Asymmetric Cryptography Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">非对称加密 (Asymmetric Cryptography)</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>非对称加密使用一对密钥：<strong class="font-bold">公钥 (public key)</strong> 和 <strong class="font-bold">私钥 (private key)</strong>。</p>
                        <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                            <li>公钥可以安全地公开分享。</li>
                            <li>私钥必须严格保密。</li>
                            <li>知道公钥无法推导出私钥。</li>
                        </ul>
                        <p>非对称系统通常提供两组核心功能：加密/解密 和 签名/验证。</p>
                        <pre class="custom-code-block text-sm"><code class="language-pseudocode">keygen() -> (public_key, private_key)

// 加密/解密
encrypt(plaintext, public_key) -> ciphertext
decrypt(ciphertext, private_key) -> plaintext
// 正确性: decrypt(encrypt(plaintext, public_key), private_key) == plaintext

// 签名/验证
sign(message, private_key) -> signature
verify(message, signature, public_key) -> bool // 验证签名是否有效
// 正确性: verify(message, sign(message, private_key), public_key) == true</code></pre>
                        
                        <div class="mt-4 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-lg font-semibold text-moon-white mb-3 flex items-center"><i class="fas fa-lock mr-2"></i>与物理锁类比</h4>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                                <li><strong class="font-bold">对称加密 ≈ 普通门锁:</strong> 同一把钥匙既能锁门也能开门。</li>
                                <li><strong class="font-bold">非对称加密 ≈ 带钥匙的挂锁:</strong> 任何人都可以用打开的挂锁（公钥）锁上箱子，但只有持有钥匙（私钥）的人才能打开。</li>
                             </ul>
                         </div>

                        <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">常用非对称算法</h3>
                         <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4">
                            <li><strong class="font-bold">RSA:</strong> 基于大整数分解难题。</li>
                            <li><strong class="font-bold">椭圆曲线密码学 (ECC):</strong> 如 ECDSA (签名), ECDH (密钥交换)。通常能用更短的密钥达到与 RSA 相同的安全级别。</li>
                         </ul>

                        <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">非对称加密应用场景</h3>
                          <div class="mt-4 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <ul class="list-disc list-inside space-y-2 text-slate-300 text-sm pl-4">
                                <li><strong class="font-bold">PGP/GPG 邮件加密:</strong> 用户发布公钥，任何人可用其加密邮件发送给该用户。</li>
                                <li><strong class="font-bold">私密消息应用 (如 Signal):</strong> 用于建立安全通信渠道（通常用于交换对称会话密钥）。</li>
                                <li><strong class="font-bold">软件签名 (如 Git 签名提交/标签):</strong> 开发者用私钥签名，用户用公钥验证软件来源和完整性。</li>
                                <li><strong class="font-bold">TLS/SSL (HTTPS):</strong> 网站服务器使用证书（包含其公钥和 CA 签名）证明身份并协商加密连接。</li>
                             </ul>
                         </div>
                         
                         <h3 class="font-sans-cn text-xl font-semibold text-indigo-highlight/80 mt-8 mb-3">混合加密 (Hybrid Encryption)</h3>
                         <p>由于非对称加密通常比对称加密慢得多，并且通常有数据长度限制，实践中发送加密消息（尤其是较长消息）通常采用<strong class="font-bold">混合加密</strong>方案：</p>
                         <div class="mt-4 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <ol class="list-decimal list-inside space-y-1 text-slate-300 text-sm pl-4">
                                <li>生成一个临时的、一次性的<strong class="font-bold">对称会话密钥</strong>。</li>
                                <li>使用接收方的<strong class="font-bold">公钥</strong>加密这个对称密钥。</li>
                                <li>使用这个对称密钥通过<strong class="font-bold">对称加密算法</strong>（如 AES-GCM）加密实际的消息数据。</li>
                                <li>将<strong class="font-bold">加密后的对称密钥</strong>和<strong class="font-bold">加密后的消息数据</strong>一起发送给接收方。</li>
                             </ol>
                             <p class="text-xs text-slate-400 mt-2">接收方用自己的私钥解密对称密钥，然后用解密出的对称密钥解密消息数据。</p>
                         </div>
                    </div>
                 </div>
            </div>
            <!-- Key Distribution Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">密钥分发 (Key Distribution)</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>非对称加密虽然强大，但面临一个核心挑战：如何安全地获取你想要与之通信的人的<strong class="font-bold">正确公钥</strong>？如何确信某个公钥确实属于声称拥有它的那个人或实体？这就是密钥分发问题。</p>
                        <p>目前存在多种解决或缓解此问题的方法：</p>
                        
                        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <!-- PKI/CA -->
                            <div class="bg-slate-700 p-4 rounded-xl shadow-lg">
                                <h4 class="font-semibold text-moon-white mb-2"><i class="fas fa-certificate mr-1 text-indigo-highlight"></i>公钥基础设施 (PKI) / CA</h4>
                                <p class="text-xs">Web (HTTPS/TLS) 的主要模型。依赖于受信任的第三方<strong class="font-bold">证书颁发机构 (CA)</strong> 来验证实体身份并为其公钥签发数字证书。你的操作系统/浏览器预装了根 CA 的证书。</p>
                            </div>
                            <!-- TOFU -->
                             <div class="bg-slate-700 p-4 rounded-xl shadow-lg">
                                <h4 class="font-semibold text-moon-white mb-2"><i class="fas fa-fingerprint mr-1 text-indigo-highlight"></i>首次使用信任 (TOFU)</h4>
                                <p class="text-xs">SSH 使用的模型。首次连接新服务器时，记录其公钥。后续连接时若公钥变化则发出警告。</p>
                            </div>
                            <!-- Web of Trust -->
                             <div class="bg-slate-700 p-4 rounded-xl shadow-lg">
                                <h4 class="font-semibold text-moon-white mb-2"><i class="fas fa-users mr-1 text-indigo-highlight"></i>Web of Trust</h4>
                                <p class="text-xs">PGP/GPG 模型。用户互相签名对方的公钥以表示信任，形成一个信任网络。</p>
                            </div>
                            <!-- Signal -->
                            <div class="bg-slate-700 p-4 rounded-xl shadow-lg">
                                <h4 class="font-semibold text-moon-white mb-2"><i class="fab fa-signal-messenger mr-1 text-indigo-highlight"></i>Signal 方案</h4>
                                <p class="text-xs">结合 TOFU 和带外验证（例如，面对面扫描安全码）。</p>
                            </div>
                            <!-- Keybase -->
                             <div class="bg-slate-700 p-4 rounded-xl shadow-lg">
                                <h4 class="font-semibold text-moon-white mb-2"><i class="fab fa-keybase mr-1 text-indigo-highlight"></i>Keybase 方案</h4>
                                <p class="text-xs">通过社交媒体账户等进行身份证明，将加密身份与在线身份关联。</p>
                            </div>
                             <!-- Key Transparency -->
                            <div class="bg-slate-700 p-4 rounded-xl shadow-lg">
                                <h4 class="font-semibold text-moon-white mb-2"><i class="fas fa-eye mr-1 text-indigo-highlight"></i>密钥透明度</h4>
                                <p class="text-xs">新兴技术，如证书透明度 (CT)，旨在使公钥的颁发和状态公开可审计。</p>
                            </div>
                        </div>
                    </div>
                 </div>
            </div>
            <!-- Case Studies Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">案例研究 (Case Studies)</h2>
                    <div class="space-y-8 text-slate-300 text-base leading-relaxed">
                        
                        <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                            <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fas fa-key mr-2 text-indigo-highlight"></i>密码管理器 (Password Managers)
                            </h4>
                            <p class="text-sm">如 KeePassXC, Bitwarden, 1Password 等工具。</p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                <li>核心思想：为每个网站/服务生成并存储<strong class="font-bold">独特、高熵的随机密码</strong>。</li>
                                <li>密码库使用对称加密（如 AES）保护，加密密钥由你的<strong class="font-bold">主密码 (master password)</strong> 通过 KDF 派生。</li>
                                <li><strong class="font-bold">巨大好处：</strong> 极大降低密码重用风险；使用强密码；你只需记住一个强主密码。</li>
                            </ul>
                        </div>

                        <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fas fa-user-lock mr-2 text-indigo-highlight"></i>双因素认证 (2FA)
                            </h4>
                            <p class="text-sm">要求除密码（你知道的东西）外，还需要第二个因素（你拥有的东西）进行验证，显著提高账户安全性，抵抗密码泄露和钓鱼攻击。</p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                <li><strong class="font-bold">TOTP (基于时间的一次性密码):</strong> 如 Google Authenticator, Authy。基于共享密钥和当前时间生成动态验证码。</li>
                                <li><strong class="font-bold">U2F/FIDO2 (WebAuthn):</strong> 基于硬件安全密钥 (如 YubiKey)。提供最高级别的安全，抗钓鱼。</li>
                                <li>短信验证码: 比没有好，但易受 SIM 卡交换攻击影响，安全性较低。</li>
                                <li>推送通知: 如 Duo Mobile。</li>
                            </ul>
                        </div>
                        
                        <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fas fa-hdd mr-2 text-indigo-highlight"></i>全盘加密 (FDE)
                            </h4>
                            <p class="text-sm">加密整个硬盘驱动器，保护静态数据，防止设备丢失或被盗时数据泄露。</p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                <li>工具: Linux <code class="custom-inline-code">cryptsetup/LUKS</code>, Windows <code class="custom-inline-code">BitLocker</code>, macOS <code class="custom-inline-code">FileVault</code>。</li>
                                <li>通常使用对称加密 (如 AES)，密钥受用户密码/密码短语 (通过 KDF 处理) 保护。</li>
                            </ul>
                        </div>

                         <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fas fa-comments mr-2 text-indigo-highlight"></i>私密消息
                            </h4>
                             <p class="text-sm"><strong class="font-bold">端到端加密 (E2EE)</strong> 是核心，确保只有发送方和接收方能阅读消息。</p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                <li>应用示例: Signal, WhatsApp, Keybase, Matrix。</li>
                                <li>关键挑战在于安全地获取和验证对方的公钥。</li>
                            </ul>
                        </div>

                        <div class="bg-slate-700 p-6 rounded-xl shadow-lg">
                             <h4 class="font-sans-cn text-xl font-semibold text-moon-white mb-3 flex items-center">
                                <i class="fab fa-osi mr-2 text-indigo-highlight"></i>SSH 回顾
                            </h4>
                             <ul class="list-disc list-inside space-y-1 text-slate-300 text-sm pl-4 mt-2">
                                <li>使用 <code class="custom-inline-code">ssh-keygen</code> 生成非对称密钥对。</li>
                                <li>私钥应使用强密码短语通过 KDF 加密保护。</li>
                                <li>认证通过基于挑战-响应的签名验证过程完成，证明客户端拥有私钥。</li>
                                <li><code class="custom-inline-code">ssh-agent</code> 可以缓存解密后的私钥，避免重复输入密码短语。</li>
                                <li>硬件密钥 (如 YubiKey) 可以更安全地存储 SSH 私钥。</li>
                            </ul>
                        </div>

                    </div>
                 </div>
            </div>
            <!-- Resources Card -->
            <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                 <div class="p-6 md:p-8">
                    <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">学习资源 (Resources)</h2>
                    <div class="space-y-4 text-slate-300 text-base leading-relaxed">
                        <p>以下是一些相关的学习资源：</p>
                        <div class="mt-6 bg-slate-700 p-4 rounded-xl shadow-lg">
                             <ul class="list-disc list-inside space-y-3 text-slate-300 text-sm pl-4">
                                <li>
                                    <a href="https://missing.csail.mit.edu/2019/security/" target="_blank" class="text-indigo-highlight hover:underline font-semibold">去年的讲座笔记</a>: 更侧重于作为用户的安全和隐私。
                                </li>
                                 <li>
                                    <a href="https://latacora.micro.blog/2018/04/03/cryptographic-right-answers.html" target="_blank" class="text-indigo-highlight hover:underline font-semibold">Cryptographic Right Answers</a>: 为常见场景提供密码学实践建议。
                                </li>
                                <li>
                                    <a href="https://cryptohack.org/" target="_blank" class="text-indigo-highlight hover:underline font-semibold">CryptoHack</a>: 通过实践挑战学习现代密码学。
                                </li>
                             </ul>
                        </div>
                    </div>
                 </div>
            </div>
                       <!-- Exercises Card -->
                       <div class="bg-slate-800 shadow-2xl rounded-xl overflow-hidden">
                        <div class="p-6 md:p-8">
                            <h2 class="font-sans-cn text-3xl font-bold text-indigo-highlight mb-6 text-center">练习 (Exercises)</h2>
                            <ol class="list-decimal list-inside space-y-8 text-slate-300 text-sm pl-4">
                                
                                <li class="pt-6 border-t border-slate-700">
                                    <p class="font-semibold text-base mb-2">1. 熵计算:</p>
                                     <ul class="list-disc list-inside space-y-3 pl-4">
                                        <li>计算由 4 个从 100,000 词字典中随机选择的单词组成的密码短语的熵。</li>
                                        <li>计算由 8 个随机选择的字母数字字符（含大小写，共 62 种可能）组成的密码的熵。</li>
                                        <li>哪个密码更强？</li>
                                        <li>假设攻击者每秒尝试 10,000 次，平均破解这两个密码各需要多长时间？</li>
                                    </ul>
                                    <details class="mt-3 bg-slate-700 p-3 rounded-lg">
                                        <summary class="cursor-pointer text-indigo-highlight/80 hover:text-indigo-highlight text-xs font-semibold">查看解答提示</summary>
                                        <div class="pt-3 text-slate-300 text-xs space-y-2">
                                            <ul>
                                                <li>密码短语熵: \\( 4 \\times \\log_2(100000) \\approx 66.4 \\) 比特。</li>
                                                <li>8 字符密码熵: \\( 8 \\times \\log_2(62) \\approx 47.6 \\) 比特。</li>
                                                <li>密码短语更强。</li>
                                                <li>破解时间 ≈ (平均尝试次数) / (尝试速率)。平均尝试次数 ≈ \\( 2^{\\text{熵}-1} \\)。
                                                    <br>短语 ≈ \\( 2^{65.4} / 10^4 \\) 秒 ≈ 3300 万年。
                                                    <br>8 字符 ≈ \\( 2^{46.6} / 10^4 \\) 秒 ≈ 31 年。
                                                </li>
                                            </ul>
                                        </div>
                                    </details>
                                </li>
        
                                <li class="pt-6 border-t border-slate-700">
                                     <p>从 Debian 镜像站下载一个小体积的 ISO 文件 (如 netinst)。找到 Debian 官方网站上发布的对应文件的 SHA256 哈希值。使用 <code class="custom-inline-code">sha256sum</code> 命令计算你下载文件的哈希值，并与官方值进行比对，验证文件完整性。</p>
                                      <!-- No specific answer hint needed, involves downloading and hashing -->
                                </li>
                                
                                <li class="pt-6 border-t border-slate-700">
                                     <p>使用 <code class="custom-inline-code">openssl aes-256-cbc -salt -pbkdf2 -iter 100000 -in {输入文件} -out {输出文件}</code> 命令加密一个文件（需要输入密码）。然后使用 <code class="custom-inline-code">openssl aes-256-cbc -d -pbkdf2 -iter 100000 -in {输出文件} -out {解密文件}</code> 解密该文件（需要输入相同密码）。最后用 <code class="custom-inline-code">cmp {输入文件} {解密文件}</code> 确认解密后的文件与原文件一致。</p>
                                      <!-- No specific answer hint needed, involves running openssl commands -->
                                </li>
        
                                <li class="pt-6 border-t border-slate-700">
                                     <p>非对称加密实践：</p>
                                     <ul class="list-disc list-inside space-y-3 pl-4">
                                        <li>设置 SSH 密钥对，确保私钥用密码短语保护，并将公钥添加到你控制的服务器上。</li>
                                        <li>安装 GPG，生成你自己的 GPG 密钥对。</li>
                                        <li>(可选) 获取讲师 Anish 的 GPG 公钥（或找一位朋友的公钥），并使用该公钥加密一条短消息。</li>
                                        <li>配置 Git 使用你的 GPG 密钥，并尝试创建一个签名的 Git 提交 (<code class="custom-inline-code">git commit -S</code>) 或标签 (<code class="custom-inline-code">git tag -s</code>)。使用 <code class="custom-inline-code">git show --show-signature</code> 或 <code class="custom-inline-code">git tag -v</code> 进行验证。</li>
                                    </ul>
                                       <!-- No specific answer hint needed, involves setting up keys and signing -->
                                </li>
        
                            </ol>
                        </div>
                    </div>
        </div>

        <!-- 导航 -->
        <nav class="mt-16 flex justify-between items-center">
            <a href="lecture-8.html" class="px-6 py-3 text-indigo-highlight hover:bg-indigo-highlight/10 rounded-md font-sans-cn">
                &larr; 上一单元 (元编程)
            </a>
            <a href="lecture-10.html" class="px-6 py-3 text-indigo-highlight hover:bg-indigo-highlight/10 rounded-md font-sans-cn">
                下一单元 (杂项) &rarr;
            </a>
        </nav>
    </main>

    <footer class="mt-20 py-10 bg-slate-800 border-t border-slate-700 text-center">
        <p class="font-sans-cn text-slate-400">
            &copy; 2025 Missing Semester 中文版. 基于 MIT 原始课程.
        </p>
        <p class="font-sans-en text-slate-500 text-sm mt-2">
            <a href="https://missing.csail.mit.edu/" target="_blank" class="hover:text-indigo-highlight">原始课程链接</a> | 
            <a href="#" class="hover:text-indigo-highlight">GitHub 仓库</a>
        </p>
        <p class="font-sans-cn text-slate-400 text-sm mt-2">
            由 <a href="https://huashanjian.github.io/" target="_blank" class="hover:text-indigo-highlight">Junhua Yao</a> 创建和维护
        </p>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/framer-motion@latest/dist/framer-motion.js"></script>
    <script>
        // Placeholder for Framer Motion scripts
    </script>
</body>
</html> 